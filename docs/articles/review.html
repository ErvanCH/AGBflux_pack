<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Review • AGBfluxes</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">AGBfluxes</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Review</h1>
                        <h4 class="author">Mauro Lepore</h4>
            
            <h4 class="date">2017-08-28</h4>
          </div>

    
    
<div class="contents">
<p>I wrote this review as a vignette in your package. When you are done reading it, you can remove it simply by deleting <code>vignettes/</code>.</p>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)</code></pre></div>
<p>Installs OK.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install_github</span>(<span class="st">"ervanSTRI/AGBflux_pack"</span>)
<span class="co">#&gt; Downloading GitHub repo ervanSTRI/AGBflux_pack@master</span>
<span class="co">#&gt; from URL https://api.github.com/repos/ervanSTRI/AGBflux_pack/zipball/master</span>
<span class="co">#&gt; Installing AGBfluxes</span>
<span class="co">#&gt; "C:/PROGRA~1/R/R-34~1.1/bin/x64/R" --no-site-file --no-environ --no-save  \</span>
<span class="co">#&gt;   --no-restore --quiet CMD INSTALL  \</span>
<span class="co">#&gt;   "C:/Users/dora/AppData/Local/Temp/RtmpENFIGF/devtools3d1c711a1ec8/ervanSTRI-AGBflux_pack-8fc882b"  \</span>
<span class="co">#&gt;   --library="C:/Users/dora/Documents/R/win-library/3.4" --install-tests</span>
<span class="co">#&gt; </span></code></pre></div>
</div>
<div id="goal" class="section level1">
<h1 class="hasAnchor">
<a href="#goal" class="anchor"></a>Goal</h1>
<ul>
<li>Searching for documentation at the package level:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AGBfluxes)
?AGBflux_pack
<span class="co">#&gt; No documentation for 'AGBflux_pack' in specified packages and libraries:</span>
<span class="co">#&gt; you could try '??AGBflux_pack'</span></code></pre></div>
<p>Needs package documentation (<a href="http://r-pkgs.had.co.nz/man.html#man-packages" class="uri">http://r-pkgs.had.co.nz/man.html#man-packages</a>)</p>
<ul>
<li>
<p>Searching for help file of any function:</p>
<ul>
<li>Typing on the console <code>AGBflux_pack::</code> + tab: Nothing pops up.</li>
</ul>
</li>
</ul>
<p>I’m wondering if the package has any function which help file is available.</p>
<p>Now jumping to the source code to see if there is a man/ folder with documentation.</p>
<p>Yes, there is documentation.</p>
<pre><code>?AGB.comp
?flag.errors
?LOAD</code></pre>
</div>
<div id="checks" class="section level1">
<h1 class="hasAnchor">
<a href="#checks" class="anchor"></a>Checks</h1>
<p>Run <code>devtools::check()</code> (find “Check” in the Build tab) and address errors, warnings and notes.</p>
<div class="figure">
<img src="https://i.imgur.com/yYzv7W0.png">
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h2>
<p>The DESCRIPTON file has a problem:</p>
<pre><code>checking DESCRIPTION meta-information ... NOTE
Malformed Title field: should not end in a period.</code></pre>
<p>To solve it, remove the period at the end of the sentence you wrote on the Title field. Also consider this (<a href="http://r-pkgs.had.co.nz/description.html" class="uri">http://r-pkgs.had.co.nz/description.html</a>)</p>
<pre><code>* shorten the sentence to 80 characters or less.
* use Title Type Capitalization</code></pre>
<p>Also, the Licence field has a problem:</p>
<pre><code>Non-standard license specification:
  What license is it under?
Standardizable: FALSE</code></pre>
<p>This should guide you to solve it:</p>
<blockquote>
<p>The License field can be either a standard abbreviation for an open source license, like GPL-2 or BSD, or a pointer to a file containing more information, file LICENSE. The license is really only important if you’re planning on releasing your package. If you don’t, you can ignore this section. If you want to make it clear that your package is not open source, use License: file LICENSE and then create a file called LICENSE, containing for example:</p>
</blockquote>
<pre><code>Proprietary 

Do not distribute outside of Widgets Incorporated.</code></pre>
<p>–<a href="http://r-pkgs.had.co.nz/description.html" class="uri">http://r-pkgs.had.co.nz/description.html</a></p>
</div>
<div id="warnings" class="section level2">
<h2 class="hasAnchor">
<a href="#warnings" class="anchor"></a>Warnings</h2>
<p>This information helps you solve a number of issues. I’ll mention a couple of important ones. You’ll be able to work out the rest. (If the information is unclear, you may find more details here; <a href="http://r-pkgs.had.co.nz/check.html" class="uri">http://r-pkgs.had.co.nz/check.html</a>)</p>
<p>In the documentation of some function, some parameters that those functions use remain undocumented. One good way to not any important piece of documentation is to step on the function’s name and press Ctrl + Shift + Alt + R. That will automatically write the roxygen skeleton of key documentation inluding all parameters. If you need to use the same parameter in multiple functions, you may avoid duplicating its documentation with <span class="citation">[@template]</span>(<a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html" class="uri">https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html</a>).</p>
<p>Also, you need to rename sume functions. For example, if you rename <code><a href="../reference/density.ind.html">density.ind()</a></code> as <code>density_ind()</code> you will avoid R thinking that <code><a href="../reference/density.ind.html">density.ind()</a></code> is an S3 method of the generic function <code>density()</code> (<a href="http://adv-r.had.co.nz/OO-essentials.html#s3" class="uri">http://adv-r.had.co.nz/OO-essentials.html#s3</a>). Again, that is why it is safer to avoid “.” in function names, unless you intend to wirite an S3 object.</p>
</div>
</div>
<div id="tests" class="section level1">
<h1 class="hasAnchor">
<a href="#tests" class="anchor"></a>Tests</h1>
<p>You are already testing, but in a non-systematic way: you write a function, run it, and see its output on the console to check check if it’s right. You, the developer, will save you a lot of time if you test systematically, with an automatic unit testing system such as the <strong><a href="https://cran.r-project.org/web/packages/testthat/testthat.pdf">testthat</a></strong> package. To use <strong>testthat</strong> you can simply run:</p>
<pre><code>devtools::use_testthat()</code></pre>
<p>Because I run that line, so you will see <code>tests/</code> in the root directory of <strong>AGBflux_pack</strong>. Then you add new tests with:</p>
<pre><code>devtools::use_test("dummytest")</code></pre>
<p>Notice that you now have the file ./tests/thestthat/test-dummytest.R.</p>
<p>Another type of test that you are already using are assertions. For example, in your code you have something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="ot">NA</span>)
if (<span class="kw">any</span>(<span class="kw">is.na</span>(x))) {<span class="kw">stop</span>(<span class="st">"x contains NA"</span>)}
<span class="co">#&gt; Error in eval(expr, envir, enclos): x contains NA</span>

<span class="co"># Or</span>
<span class="kw">stopifnot</span>(!<span class="kw">any</span>(<span class="kw">is.na</span>(x)))
<span class="co">#&gt; Error: !any(is.na(x)) is not TRUE</span></code></pre></div>
<p>Assertions are nicely implemented with the <strong><a href="https://cran.r-project.org/web/packages/assertive/assertive.pdf">assertive</a></strong> package. With <strong>assertive</strong> you can do something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">assertive::<span class="kw">assert_all_are_not_na</span>(x)
<span class="co">#&gt; Error in assert_engine(is_not_na, x, coerce_to_logical = FALSE, msg = msg, : object 'x' not found</span>
<span class="co"># Warn instead or err</span>
assertive::<span class="kw">assert_all_are_not_na</span>(x, <span class="dt">severity =</span> <span class="st">"warning"</span>)
<span class="co">#&gt; Error in assert_engine(is_not_na, x, coerce_to_logical = FALSE, msg = msg, : object 'x' not found</span></code></pre></div>
<p>Assertions target not the developer but the user; they err, warn of give messages to the user when something is wrong or suspicious.</p>
<p>This are good resources to learn more about unit tests and assertions:</p>
<ul>
<li><a href="http://r-pkgs.had.co.nz/tests.html" class="uri">http://r-pkgs.had.co.nz/tests.html</a></li>
<li>
<a href="https://www.crcpress.com/Testing-R-Code/Cotton/p/book/9781498763653">Testing R code, by Richard Cotton</a>.</li>
</ul>
</div>
<div id="file-descripton" class="section level1">
<h1 class="hasAnchor">
<a href="#file-descripton" class="anchor"></a>File DESCRIPTON</h1>
<p>Fields and comments:</p>
<ul>
<li>
<code>Type:</code> I’m not sure what this field does.</li>
<li>
<code>Version:</code> Consider using a development version until released. The book <em>R Packages</em> recommends adding .9000 to the end of a development verison number to clearly indicate it is not a released version.</li>
<li>Author<code>and</code>Maintainer<code>: Both fields can be documented with</code>person()<code>(see</code>?person<code>).</code>person()` also offers other potentially useful roles.</li>
</ul>
</div>
<div id="functions" class="section level1">
<h1 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h1>
<ul>
<li><p><strong>Grouping functions within files.</strong> Consider grouping functions in files by topic.</p></li>
<li><p><strong>Tab versus space.</strong> Avoid using tab to insert spaces. Instead use space (see section <em>Style</em>).</p></li>
<li><p><strong>Lines width.</strong> Keep the widh of each line no longer than 80 characters. This improves readability. To achive this:</p></li>
<li><p>Set a guide line at 80 characters page width: Tools &gt; Global Options &gt; Code &gt; Display &gt; Show Margin &gt; Margin Column = 80.</p></li>
<li>For comments (both normal comments and roxygen comments), master these two keyboard shortcuts:
<ul>
<li>Shift + Control + C to comment a line/paragraph.</li>
<li>Shift + Control + / to brake a paragraph into lines no longer than 80 characters.</li>
</ul>
</li>
<li><p>Conform with a style guide (see section Style) by reformating the code manually or with (select then) Control + Shift + A, or <code>formatR::tidy_code()</code> (this one, you likely have in your Addins popup menu). This will add spaces after commas, brake lines to fit within 80 characters width, add spaces around equal signs, etc. You may dislike that formatting style butitiseasiertoread.</p></li>
<li><p>Check the style of your package with the <strong>lintr</strong> package. Also see <code>goodpractice::gp()</code>.</p></li>
</ul>
<div id="author" class="section level2">
<h2 class="hasAnchor">
<a href="#author" class="anchor"></a>Author</h2>
<p>If the author of the package is the author of a function, then that author needs not to be explicitely mentioned in each help file.</p>
<p>In other words, use @author in help files of functions written but people other than the authors of the package.</p>
</div>
</div>
<div id="style" class="section level1">
<h1 class="hasAnchor">
<a href="#style" class="anchor"></a>Style</h1>
<p>Use a style guide, e.g.</p>
<ul>
<li>
<a href="http://style.tidyverse.org/" class="uri">http://style.tidyverse.org/</a> (the one I use).</li>
<li>
<a href="https://google.github.io/styleguide/Rguide.xml" class="uri">https://google.github.io/styleguide/Rguide.xml</a>.</li>
</ul>
<blockquote>
<p>Variable and function names should use only lowercase letters, numbers, and _.</p>
</blockquote>
<blockquote>
<p>Use underscores (_) to separate words within a name. Base R uses dots in function names (contrib.url()) and class names (data.frame), but it’s better to reserve dots exclusively for the S3 object system. In S3, methods are given the name function.class; if you also use . in function and class names you end up with confusing methods like as.data.frame.data.frame().</p>
</blockquote>
<p>–<a href="http://style.tidyverse.org/syntax.html#object-names" class="uri">http://style.tidyverse.org/syntax.html#object-names</a></p>
<pre><code>i_use_snake_case
otherPeopleUseCamelCase
some.people.use.periods
And_aFew.People_RENOUNCEconvention</code></pre>
<p>–<a href="http://r4ds.had.co.nz/workflow-basics.html#whats-in-a-name" class="uri">http://r4ds.had.co.nz/workflow-basics.html#whats-in-a-name</a></p>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>You usually need some data, even dummy data, for examples and tests. See <code>devtools::use_data()</code>. Or you may want to place data in its own package. An example of this is the package <strong>babynames</strong>. This allows you to reuse the same data in different projects, and to track data versions in the same way you can track package versions. A specific version is easy to install with <code>devtools::install_github("username/packagename@version")</code>.</p>
</div>
<div id="other-things-to-start-thinking-about" class="section level1">
<h1 class="hasAnchor">
<a href="#other-things-to-start-thinking-about" class="anchor"></a>Other things to start thinking about</h1>
<ul>
<li><p>Once you are using automated unit tests, you may want to measuere code cover. For example with the <strong>covr</strong> package (see <code>devtools::use_coverage()</code>).</p></li>
<li><p>Once you are confident of the checks you do locally, you may want to use continuous integration. For example with TravisCI (see <code>devtools::use_travis()</code>).</p></li>
</ul>
</div>
<div id="readme" class="section level1">
<h1 class="hasAnchor">
<a href="#readme" class="anchor"></a>README</h1>
<p>Add a README file with <code>devtools::use_readme_rmd()</code>. This file will be the Home of the package website.</p>
</div>
<div id="package-infrasctructure" class="section level1">
<h1 class="hasAnchor">
<a href="#package-infrasctructure" class="anchor"></a>Package infrasctructure</h1>
<p>See <code>?devtools::infrastructure</code>. Here are a number of functins that will be handy to improve your package. The ones I commonly use are these:</p>
<pre><code>library(devtools)

# Tests and checks
use_testthat(pkg = ".")
use_test(name, pkg = ".")
use_travis(pkg = ".", browse = interactive())
use_coverage(pkg = ".", type = c("codecov", "coveralls"))

# Documentation
use_package_doc(pkg = ".")
use_vignette(name, pkg = ".")

# Edits DESCRIPTION
use_dev_version(pkg = ".")
use_gpl3_license(pkg = ".")</code></pre>
</div>
<div id="website" class="section level1">
<h1 class="hasAnchor">
<a href="#website" class="anchor"></a>Website</h1>
<p>You can make a website for your package with <code>pkgdown::build_site()</code>. I made one (see folder docs/) which you can host on GitHub (Settings &gt; GitHubPages &gt; Source &gt; master branch /docs folder). But you’d want to update the website often to incorporate the latests features of your package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#goal">Goal</a></li>
      <li>
<a href="#checks">Checks</a><ul class="nav nav-pills nav-stacked">
<li><a href="#notes">Notes</a></li>
      <li><a href="#warnings">Warnings</a></li>
      </ul>
</li>
      <li><a href="#tests">Tests</a></li>
      <li><a href="#file-descripton">File DESCRIPTON</a></li>
      <li>
<a href="#functions">Functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#author">Author</a></li>
      </ul>
</li>
      <li><a href="#style">Style</a></li>
      <li><a href="#data">Data</a></li>
      <li><a href="#other-things-to-start-thinking-about">Other things to start thinking about</a></li>
      <li><a href="#readme">README</a></li>
      <li><a href="#package-infrasctructure">Package infrasctructure</a></li>
      <li><a href="#website">Website</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ervan Rutishauser.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
